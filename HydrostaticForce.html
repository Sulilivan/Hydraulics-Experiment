<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="UTF-8">
    <title>净水总压力实验计算</title>
    <style>
        table, th, td {
            border: 1px solid #333;
            border-collapse: collapse;
            padding: 4px 8px;
            text-align: center;
        }
        th {
            background: #f0f0f0;
        }
        input[type="number"] {
            width: 70px;
        }
    </style>
</head>
<body>
<h2>净水总压力实验数据输入与计算</h2>
<form id="expForm" autocomplete="off">
    <h3>2、有关常数</h3>
    <label>天平臂距离 L₀ (cm)：<input name="L0" type="number" step="0.01" required></label>
    <label>扇形体垂直距离 L (cm)：<input name="L" type="number" step="0.01" required></label>
    <label>扇形体宽度 b (cm)：<input name="b" type="number" step="0.01" required></label>
    <label>扇形体平面高度 H0 (cm)：<input name="H0" type="number" step="0.01" required></label>
    <br><br>
    <h3>3、量测记录表格</h3>
    <table>
        <tr>
            <th rowspan="2">压强分布形式</th>
            <th rowspan="2">测次</th>
            <th colspan="1">水位读数 H (cm)</th>
            <th colspan="1">砝码质量 m (g)</th>
        </tr>
        <tr>
            <th>H</th>
            <th>m</th>
        </tr>
        <!-- 三角形分布 -->
        <tr>
            <td rowspan="3">三角形分布</td>
            <td>1</td>
            <td><input name="H_tri_1" type="number" step="0.01" required></td>
            <td><input name="m_tri_1" type="number" step="0.01" required></td>
        </tr>
        <tr>
            <td>2</td>
            <td><input name="H_tri_2" type="number" step="0.01" required></td>
            <td><input name="m_tri_2" type="number" step="0.01" required></td>
        </tr>
        <tr>
            <td>3</td>
            <td><input name="H_tri_3" type="number" step="0.01" required></td>
            <td><input name="m_tri_3" type="number" step="0.01" required></td>
        </tr>
        <!-- 梯形分布 -->
        <tr>
            <td rowspan="3">梯形分布</td>
            <td>1</td>
            <td><input name="H_trap_1" type="number" step="0.01" required></td>
            <td><input name="m_trap_1" type="number" step="0.01" required></td>
        </tr>
        <tr>
            <td>2</td>
            <td><input name="H_trap_2" type="number" step="0.01" required></td>
            <td><input name="m_trap_2" type="number" step="0.01" required></td>
        </tr>
        <tr>
            <td>3</td>
            <td><input name="H_trap_3" type="number" step="0.01" required></td>
            <td><input name="m_trap_3" type="number" step="0.01" required></td>
        </tr>
    </table>
    <br>
    <button type="button" onclick="calc()">计算并输出结果</button>
</form>
<br>
<div id="result"></div>
<script>
function calc() {
    // 常量
    const rho = 1000; // kg/m³
    const g = 9.81; // m/s²
    const gcm = 9.81e-2; // cm单位下的g, N/(g·cm)
    // 读取常数
    const form = document.getElementById("expForm");
    const L0 = +form.elements["L0"].value; // cm
    const L = +form.elements["L"].value;   // cm
    const b = +form.elements["b"].value;   // cm
    const H0 = +form.elements["H0"].value; // cm

    // 输出表头
    let html = `<h3>4、计算表格</h3>
    <table>
    <tr>
        <th rowspan="2">压强分布形式</th>
        <th rowspan="2">测次</th>
        <th rowspan="2">作用点距底部距离<br>e (cm)</th>
        <th rowspan="2">作用点距支点垂直距离<br>L₁ = L - e (cm)</th>
        <th rowspan="2">实测力矩<br>M₀ = m·g·L₀ (Ncm)</th>
        <th rowspan="2">实测静水压力<br>P实 (N)</th>
        <th rowspan="2">理论静水压力<br>P理 (N)</th>
        <th rowspan="2">相对值<br>y = P实 / P理</th>
    </tr>
    </table>`;

    // 计算并输出每组数据
    let rows = '';
    // 三角形分布
    for(let i=1;i<=3;i++) {
        let H = +form.elements[`H_tri_${i}`].value; // cm
        let m = +form.elements[`m_tri_${i}`].value; // g
        // 作用点距底部距离 e = 2/3 H
        let e = (2/3 * H).toFixed(2);
        // 作用点距支点垂直距离 L1 = L - e
        let L1 = (L - e).toFixed(2);
        // 实测力矩 M0 = m·g·L0 (Ncm)
        let M0 = (m * gcm * L0).toFixed(2);
        // 实测静水压力 P实 = M0 / L1 (N)
        let P_exp = (L1 != 0 ? (M0 / L1).toFixed(2) : '');
        // 理论静水压力 P理 = 0.5 * rho * g * b * H^2 (cm制，需转m)
        let H_m = H / 100;
        let b_m = b / 100;
        let P_theory = (0.5 * rho * g * b_m * H_m * H_m).toFixed(2);
        // 相对值
        let y = (P_theory != 0 ? (P_exp / P_theory).toFixed(3) : '');
        rows += `<tr>
            <td>三角形分布</td>
            <td>${i}</td>
            <td>${e}</td>
            <td>${L1}</td>
            <td>${M0}</td>
            <td>${P_exp}</td>
            <td>${P_theory}</td>
            <td>${y}</td>
        </tr>`;
    }
    // 梯形分布
    for(let i=1;i<=3;i++) {
        let H = +form.elements[`H_trap_${i}`].value; // cm
        let m = +form.elements[`m_trap_${i}`].value; // g
        // 作用点距底部距离 e = (H + 2*H0)/3H * H0 (梯形分布，假设H0为底高)
        // 梯形分布理论压力和作用点公式需根据具体实验装置调整，这里用常见公式：
        // P理 = 0.5 * rho * g * b * H0^2 + rho * g * b * H0 * (H-H0)
        // 作用点 e = [ (1/3)*H0^3 + 0.5*H0^2*(H-H0) + 0.5*H0*(H-H0)^2 + (1/3)*(H-H0)^3 ] / P理
        let H0_m = H0 / 100;
        let H_m = H / 100;
        let b_m = b / 100;
        // 理论静水压力
        let P_theory = (0.5 * rho * g * b_m * H0_m * H0_m + rho * g * b_m * H0_m * (H_m - H0_m)).toFixed(2);
        // 作用点理论距离
        let num = (1/3)*Math.pow(H0_m,3) + 0.5*Math.pow(H0_m,2)*(H_m-H0_m) + 0.5*H0_m*Math.pow(H_m-H0_m,2) + (1/3)*Math.pow(H_m-H0_m,3);
        let e = (P_theory != 0 ? (num / (P_theory/(rho*g*b_m))).toFixed(2) : '');
        // 作用点距支点垂直距离 L1 = L - e
        let L1 = (L - e).toFixed(2);
        // 实测力矩 M0 = m·g·L0 (Ncm)
        let M0 = (m * gcm * L0).toFixed(2);
        // 实测静水压力 P实 = M0 / L1 (N)
        let P_exp = (L1 != 0 ? (M0 / L1).toFixed(2) : '');
        // 相对值
        let y = (P_theory != 0 ? (P_exp / P_theory).toFixed(3) : '');
        rows += `<tr>
            <td>梯形分布</td>
            <td>${i}</td>
            <td>${e}</td>
            <td>${L1}</td>
            <td>${M0}</td>
            <td>${P_exp}</td>
            <td>${P_theory}</td>
            <td>${y}</td>
        </tr>`;
    }
    // 输出表格
    html = html.replace('</table>', rows + '</table>');
    document.getElementById('result').innerHTML = html;
}
</script>
</body>
</html>